module math
    implicit none
    
    !-----------------------------------------------------------------------!
    !   ( INTERFACE ) ( OPERATOR ) .times.                                  !
    !-----------------------------------------------------------------------!
    !   Operates the cross product of a pair of R3 vectors.                 !
    !-----------------------------------------------------------------------!
    !   Parameters: !                                                       !
    !---------------!-------------------------------------------------------!
    !   IN          ! (real(3)) v1                                          !
    !               ! First R3 vector.                                      !
    !---------------!-------------------------------------------------------!
    !   IN          ! (real(3)) v2                                          !
    !               ! Second R3 vector.                                     !
    !---------------!-------------------------------------------------------!
    !   OUT         ! (real(3)) v3                                          !
    !               ! Cross product of v1 and v2: v3 = v1 x v2.             !
    !---------------!-------------------------------------------------------!
    interface operator (.times.)
        module procedure times_r3
    end interface
    
    private
    public :: operator (.times.)
    
    contains
    
    !-----------------------------------------------------------------------!
    !   ( FUNCTION ) times_r3                                               !
    !-----------------------------------------------------------------------!
    !   Implementation of the cross product of a pair of R3 vectors.        !
    !-----------------------------------------------------------------------!
    !   Parameters: !                                                       !
    !---------------!-------------------------------------------------------!
    !   IN          ! (real(3)) v1                                          !
    !               ! First R3 vector.                                      !
    !---------------!-------------------------------------------------------!
    !   IN          ! (real(3)) v2                                          !
    !               ! Second R3 vector.                                     !
    !---------------!-------------------------------------------------------!
    !   OUT         ! (real(3)) v3                                          !
    !               ! Cross product of v1 and v2: v3 = v1 x v2.             !
    !---------------!-------------------------------------------------------!
    function times_r3(v1, v2) result(v3)
        real, intent(in) :: v1(3), v2(3)
        real :: v3(3)
        
        v3(1) = v1(2)*v2(3) - v1(3)*v2(2)
        v3(2) = v1(3)*v2(1) - v1(1)*v2(3)
        v3(3) = v1(1)*v2(2) - v1(2)*v2(1)
    end function times_r3
end module math